spring:
  datasource:
    master:
      url: jdbc:postgresql://localhost:15432/groom
      username: application
      password: application
      driver-class-name: org.postgresql.Driver
    replica:
      url: jdbc:postgresql://localhost:15433/groom
      username: application
      password: application
      driver-class-name: org.postgresql.Driver
      hikari:
        maximum-pool-size: 5

# Platform Core DataSource 라우팅 설정
platform:
  datasource:
    replica-enabled: true
  jpa:
    hibernate:
      ddl-auto: none
      naming:
        implicit-strategy: org.springframework.boot.orm.jpa.hibernate.SpringImplicitNamingStrategy
        physical-strategy: org.hibernate.boot.model.naming.CamelCaseToUnderscoresNamingStrategy
    properties:
      hibernate:
        format_sql: true  # SQL 포맷팅 활성화 (개발 환경)
        dialect: org.hibernate.dialect.PostgreSQLDialect
    show-sql: false  # logback으로 제어 (중복 방지)

# ====================================
# local 환경 로그 레벨 (개발 환경)
# ====================================
logging:
  level:
    # 프로젝트 패키지 - DEBUG 레벨 (상세 개발 로그)
    com.groom.order: DEBUG

    # Spring Framework
    org.springframework: INFO
    org.springframework.web: DEBUG  # HTTP 요청/응답 디버깅

    # Hibernate/JPA - SQL 쿼리 디버깅
    org.hibernate: INFO
    org.hibernate.SQL: DEBUG  # SQL 쿼리 출력
    org.hibernate.orm.jdbc.bind: TRACE  # SQL 파라미터 바인딩 (Hibernate 6.x)
    org.hibernate.type.descriptor.sql.BasicBinder: TRACE  # SQL 파라미터 바인딩 (Hibernate 5.x)

  file:
    path: ./logs

# ====================================
# 로컬 개발환경 설정
# ====================================
# LocalDevAuthFilter가 활성화되어 Istio 헤더를 자동 주입합니다.
# - X-User-Id: 00000000-0000-0000-0000-000000000001
# - X-User-Role: CUSTOMER
#
# 커스텀 헤더로 테스트하려면:
# curl -H "X-User-Id: your-uuid" -H "X-User-Role: CUSTOMER" http://localhost:8084/api/v1/orders

feign:
  clients:
    store-service:
      url: http://localhost:8084
      connect-timeout: 10000
      read-timeout: 10000
      logger-level: full
  client:
    config:
      store-service:
        loggerLevel: full

# Kafka Producer 설정 (로컬 개발 환경)
kafka:
  bootstrap-servers: localhost:9092
  producer:
    acks: all
    retries: 3
  schema-registry:
    url: http://localhost:8081
  topics:
    store-info-updated: store.info.updated
    store-deleted: store.deleted
